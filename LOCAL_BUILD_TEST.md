# æœ¬åœ°æ‰“åŒ…æ¸¬è©¦æµç¨‹

> **é‡è¦**ï¼šåœ¨æ¨é€åˆ° GitHub å’Œå‰µå»º Release ä¹‹å‰ï¼Œå¿…é ˆåœ¨æœ¬åœ°å®Œæˆä»¥ä¸‹æ¸¬è©¦ï¼

## ğŸ¯ æ¸¬è©¦ç›®æ¨™

ç¢ºä¿æ‰“åŒ…å¾Œçš„æ‡‰ç”¨ç¨‹å¼èƒ½å¤ æ­£å¸¸é‹è¡Œï¼Œæ‰€æœ‰ä¾è³´å’Œè³‡æºéƒ½æ­£ç¢ºåŒ…å«ã€‚

## ğŸ“‹ æ¸¬è©¦æ­¥é©Ÿ

### 1. æ¸…ç†èˆŠçš„æ§‹å»º

```bash
# åˆªé™¤èˆŠçš„æ§‹å»ºæ–‡ä»¶
rm -rf dist/ build/ releases/
```

### 2. æœ¬åœ°æ‰“åŒ…

```bash
# åŸ·è¡Œæ‰“åŒ…ï¼ˆåƒ…æ‰“åŒ…ï¼Œä¸å‰µå»ºç™¼å¸ƒåŒ…ï¼‰
python scripts/build.py --no-package

# æˆ–è€…å‰µå»ºå®Œæ•´çš„ç™¼å¸ƒåŒ…ï¼ˆåŒ…æ‹¬ ZIPï¼‰
python scripts/build.py
```

**é æœŸè¼¸å‡º**ï¼š
- âœ… æ‰“åŒ…æˆåŠŸè¨Šæ¯
- ğŸ“ ç”Ÿæˆ `dist/BaslerVisionSystem/` ç›®éŒ„
- ğŸ“„ åŒ…å«åŸ·è¡Œæª”å’Œæ‰€æœ‰ä¾è³´

### 3. æ¸¬è©¦åŸ·è¡Œæª”

#### macOS / Linux
```bash
cd dist/BaslerVisionSystem
./BaslerVisionSystem
```

#### Windows
```cmd
cd dist\BaslerVisionSystem
BaslerVisionSystem.exe
```

**æª¢æŸ¥é …ç›®**ï¼š
- âœ… ç¨‹å¼èƒ½æ­£å¸¸å•Ÿå‹•
- âœ… ä¸»è¦–çª—æ­£ç¢ºé¡¯ç¤º
- âœ… æ²’æœ‰ ModuleNotFoundError æˆ– ImportError
- âœ… é…ç½®æ–‡ä»¶èƒ½æ­£ç¢ºè¼‰å…¥
- âœ… æ‰€æœ‰åŠŸèƒ½é¢æ¿æ­£å¸¸é¡¯ç¤º

### 4. æ¸¬è©¦æ ¸å¿ƒåŠŸèƒ½

#### a. è¼‰å…¥æ¸¬è©¦å½±ç‰‡
1. é»æ“Š **æª”æ¡ˆ > è¼‰å…¥å½±ç‰‡æª”æ¡ˆ**
2. é¸æ“‡æ¸¬è©¦å½±ç‰‡ï¼ˆå¦‚æœæœ‰æ‰“åŒ… testDataï¼‰
3. ç¢ºèªå½±ç‰‡èƒ½æ­£å¸¸æ’­æ”¾

#### b. åµæ¸¬åŠŸèƒ½æ¸¬è©¦
1. èª¿æ•´åµæ¸¬åƒæ•¸
2. ç¢ºèªå³æ™‚åµæ¸¬æ­£å¸¸é‹ä½œ
3. æª¢æŸ¥è™›æ“¬å…‰æŸµè¨ˆæ•¸åŠŸèƒ½

#### c. éŒ„å½±åŠŸèƒ½æ¸¬è©¦
1. é»æ“Šé–‹å§‹éŒ„å½±
2. åœæ­¢éŒ„å½±
3. ç¢ºèªå½±ç‰‡æª”æ¡ˆæ­£ç¢ºç”Ÿæˆ

### 5. æª¢æŸ¥æ§åˆ¶å°è¼¸å‡º

**ç•¶å‰ spec è¨­ç½®**ï¼š`console=True`ï¼ˆèª¿è©¦æ¨¡å¼ï¼‰

æª¢æŸ¥æ§åˆ¶å°æ˜¯å¦æœ‰ï¼š
- âŒ éŒ¯èª¤è¨Šæ¯ï¼ˆError/Exceptionï¼‰
- âš ï¸ è­¦å‘Šè¨Šæ¯ï¼ˆWarningï¼‰
- â„¹ï¸ æ­£å¸¸é‹è¡Œæ—¥èªŒ

**å¸¸è¦‹éŒ¯èª¤**ï¼š
- `ModuleNotFoundError`: ç¼ºå°‘ Python æ¨¡çµ„ â†’ éœ€è¦æ·»åŠ åˆ° `hiddenimports`
- `FileNotFoundError`: ç¼ºå°‘è³‡æºæ–‡ä»¶ â†’ éœ€è¦æ·»åŠ åˆ° `datas`
- DLL/å…±äº«åº«éŒ¯èª¤ â†’ éœ€è¦æ·»åŠ åˆ° `binaries`

### 6. æª¢æŸ¥æ‰“åŒ…å…§å®¹

```bash
# æŸ¥çœ‹æ‰“åŒ…å¾Œçš„æª”æ¡ˆçµæ§‹
cd dist/BaslerVisionSystem
tree -L 2  # æˆ–ä½¿ç”¨ ls -R

# æª¢æŸ¥é—œéµæ–‡ä»¶
ls -lh config/detection_params.json    # é…ç½®æ–‡ä»¶
ls -lh _internal/                       # ä¾è³´åº«
```

**å¿…é ˆåŒ…å«çš„æ–‡ä»¶**ï¼š
- âœ… `BaslerVisionSystem` åŸ·è¡Œæª”
- âœ… `config/detection_params.json` é…ç½®æ–‡ä»¶
- âœ… `_internal/` ç›®éŒ„ï¼ˆåŒ…å«æ‰€æœ‰ä¾è³´ï¼‰
- âœ… NumPyã€OpenCVã€PyQt6 ç­‰åº«

### 7. é•·æ™‚é–“é‹è¡Œæ¸¬è©¦

```bash
# è®“ç¨‹å¼é‹è¡Œ 5-10 åˆ†é˜ï¼Œæª¢æŸ¥ï¼š
# - è¨˜æ†¶é«”æ´©æ¼
# - CPU ä½¿ç”¨ç‡
# - ç©©å®šæ€§
```

## ğŸ› å¸¸è¦‹å•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆ

### å•é¡Œ 1: NumPy Import Error

**éŒ¯èª¤**ï¼š`ModuleNotFoundError: No module named 'numpy._core._exceptions'`

**è§£æ±º**ï¼š
```python
# åœ¨ basler_pyqt6.spec çš„ hiddenimports ä¸­æ·»åŠ ï¼š
'numpy._core',
'numpy._core._exceptions',
'numpy._core._multiarray_umath',
```

### å•é¡Œ 2: PyQt6 ç¼ºå°‘æ’ä»¶

**éŒ¯èª¤**ï¼š`qt.qpa.plugin: Could not find the Qt platform plugin`

**è§£æ±º**ï¼š
```python
# åœ¨ spec æ–‡ä»¶ä¸­æ·»åŠ ï¼š
from PyInstaller.utils.hooks import collect_data_files
datas += collect_data_files('PyQt6', include_py_files=False)
```

### å•é¡Œ 3: é…ç½®æ–‡ä»¶æ‰¾ä¸åˆ°

**éŒ¯èª¤**ï¼š`FileNotFoundError: detection_params.json`

**æª¢æŸ¥**ï¼š
```python
# basler_pyqt6.spec ä¸­ç¢ºä¿ï¼š
datas = [
    ('basler_pyqt6/config/detection_params.json', 'config'),
]
```

### å•é¡Œ 4: OpenCV ç›¸æ©Ÿç„¡æ³•æ‰“é–‹

**éŒ¯èª¤**ï¼š`cv2.VideoCapture` è¿”å› None

**è§£æ±º**ï¼šå¯èƒ½ç¼ºå°‘ OpenCV çš„å‹•æ…‹åº«ï¼Œæª¢æŸ¥ `_internal/cv2/` ç›®éŒ„ã€‚

## âœ… æ¸¬è©¦é€šéæ¨™æº–

æ‰€æœ‰ä»¥ä¸‹é …ç›®å¿…é ˆé€šéæ‰èƒ½æ¨é€åˆ° GitHubï¼š

- [x] æ‰“åŒ…æˆåŠŸï¼Œç„¡éŒ¯èª¤
- [x] ç¨‹å¼èƒ½æ­£å¸¸å•Ÿå‹•
- [x] ä¸»è¦–çª—æ­£ç¢ºé¡¯ç¤º
- [x] èƒ½è¼‰å…¥æ¸¬è©¦å½±ç‰‡
- [x] åµæ¸¬åŠŸèƒ½æ­£å¸¸é‹ä½œ
- [x] éŒ„å½±åŠŸèƒ½æ­£å¸¸
- [x] æ§åˆ¶å°ç„¡åš´é‡éŒ¯èª¤
- [x] é‹è¡Œ 10 åˆ†é˜ç„¡å´©æ½°

## ğŸš€ æ¸¬è©¦é€šéå¾Œçš„ç™¼å¸ƒæµç¨‹

### 1. ä¿®æ”¹ console è¨­ç½®ï¼ˆæ­£å¼ç™¼å¸ƒï¼‰

```python
# basler_pyqt6.spec
console=False,  # é—œé–‰æ§åˆ¶å°çª—å£
```

### 2. é‡æ–°æ‰“åŒ…æ­£å¼ç‰ˆ

```bash
python scripts/build.py
```

### 3. æœ€çµ‚æ¸¬è©¦

å†æ¬¡é‹è¡Œæ‰“åŒ…å¾Œçš„ç¨‹å¼ï¼Œç¢ºèªï¼š
- ç„¡æ§åˆ¶å°çª—å£å½ˆå‡º
- åŠŸèƒ½æ­£å¸¸

### 4. æäº¤ä¸¦å‰µå»º Release

```bash
# æäº¤ä¿®æ”¹
git add basler_pyqt6.spec
git commit -m "fix: ä¿®å¾©æ‰“åŒ…ä¾è³´å•é¡Œï¼Œç¢ºä¿ NumPy æ­£ç¢ºæ‰“åŒ…"
git push

# æ›´æ–°ç‰ˆæœ¬è™Ÿï¼ˆå¦‚æœéœ€è¦ï¼‰
# ç·¨è¼¯ basler_pyqt6/version.py

# å‰µå»ºä¸¦æ¨é€ tag
git tag v2.0.5
git push origin v2.0.5
```

### 5. ç›£æ§ GitHub Actions

å‰å¾€ Actions é é¢ï¼Œç¢ºèªï¼š
- Windows/macOS/Linux ä¸‰å€‹å¹³å°éƒ½æˆåŠŸæ§‹å»º
- Release å‰µå»ºæˆåŠŸ
- æ‰€æœ‰å®‰è£åŒ…éƒ½æ­£ç¢ºä¸Šå‚³

## ğŸ“ æœ¬åœ°æ¸¬è©¦è¨˜éŒ„ç¯„æœ¬

```markdown
## æ¸¬è©¦æ—¥æœŸï¼š2025-10-23

### ç’°å¢ƒ
- ä½œæ¥­ç³»çµ±ï¼šmacOS 15.0
- Python ç‰ˆæœ¬ï¼š3.12.0
- PyInstaller ç‰ˆæœ¬ï¼š6.11.1

### æ¸¬è©¦çµæœ
- [x] æ‰“åŒ…æˆåŠŸ
- [x] ç¨‹å¼å•Ÿå‹•æ­£å¸¸
- [x] è¼‰å…¥å½±ç‰‡åŠŸèƒ½æ­£å¸¸
- [x] åµæ¸¬åŠŸèƒ½æ­£å¸¸
- [x] éŒ„å½±åŠŸèƒ½æ­£å¸¸
- [x] é•·æ™‚é–“é‹è¡Œç©©å®š

### ç™¼ç¾çš„å•é¡Œ
- ç„¡

### å‚™è¨»
- å·²æ¸¬è©¦ NumPy 2.3.3 ç‰ˆæœ¬æ‰“åŒ…
- æ·»åŠ äº† numpy._core ç›¸é—œéš±è—å°å…¥
```

## ğŸ”§ èª¿è©¦æŠ€å·§

### æŸ¥çœ‹æ‰“åŒ…æ—¥èªŒ
```bash
python scripts/build.py 2>&1 | tee build.log
```

### ä½¿ç”¨èª¿è©¦æ¨¡å¼
```python
# basler_pyqt6.spec
exe = EXE(
    ...
    debug=True,  # å•Ÿç”¨èª¿è©¦æ¨¡å¼
    console=True,  # é¡¯ç¤ºæ§åˆ¶å°
    ...
)
```

### æª¢æŸ¥ä¾è³´
```bash
# ä½¿ç”¨ PyInstaller çš„åˆ†æå·¥å…·
pyi-archive_viewer dist/BaslerVisionSystem/BaslerVisionSystem
```

---

**è¨˜ä½**ï¼šå…ˆæœ¬åœ°æ¸¬è©¦ï¼Œå¾Œ GitHub ç™¼å¸ƒï¼ğŸ¯
